from Config.StockConfig import StockCode, StockDataType
from Core.Provider.TuShare import TuShare
from Database.MongoDB import Client
import Common.StringUtils as str_utils
import pandas as pd
import bson
import datetime


csv_path = ".\\test1.csv"

def test():
    ts = TuShare()
    mongodb_client = Client.Client()
    start_date = "2018-10-01"
    end_date = "2018-10-11"

    ttt = str_utils.date_to_object_id(start_date)
    print(ttt)

    for stock in StockCode.Test:
        # df = ts.get_1min_stock_price(stock, start_date, end_date)
        df = pd.read_csv(csv_path)
        print(df.head(10))
        # df.to_csv(csv_path, index=False)
        # t_df = pd.read_csv(csv_path)
        # print(t_df.head(10))
        # print(t_df.to_json())
        # df = "{'trade_time': {'0': '2018-10-10 15:00:00', '1': '2018-10-10 14:59:00', '2': '2018-10-10 14:58:00', '3': '2018-10-10 14:57:00', '4': '2018-10-10 14:56:00', '5': '2018-10-10 14:55:00', '6': '2018-10-10 14:53:00', '7': '2018-10-10 14:52:00', '8': '2018-10-10 14:51:00', '9': '2018-10-10 14:50:00', '10': '2018-10-10 14:48:00', '11': '2018-10-10 14:47:00', '12': '2018-10-10 14:46:00', '13': '2018-10-10 14:45:00', '14': '2018-10-10 14:44:00', '15': '2018-10-10 14:43:00', '16': '2018-10-10 14:42:00', '17': '2018-10-10 14:39:00', '18': '2018-10-10 14:38:00', '19': '2018-10-10 14:37:00', '20': '2018-10-10 14:35:00', '21': '2018-10-10 14:34:00', '22': '2018-10-10 14:33:00', '23': '2018-10-10 14:32:00', '24': '2018-10-10 14:31:00', '25': '2018-10-10 14:30:00', '26': '2018-10-10 14:28:00', '27': '2018-10-10 14:27:00', '28': '2018-10-10 14:26:00', '29': '2018-10-10 14:23:00', '30': '2018-10-10 14:22:00', '31': '2018-10-10 14:21:00', '32': '2018-10-10 14:19:00', '33': '2018-10-10 14:18:00', '34': '2018-10-10 14:14:00', '35': '2018-10-10 14:12:00', '36': '2018-10-10 14:11:00', '37': '2018-10-10 14:09:00', '38': '2018-10-10 14:08:00', '39': '2018-10-10 14:06:00', '40': '2018-10-10 14:05:00', '41': '2018-10-10 14:04:00', '42': '2018-10-10 14:03:00', '43': '2018-10-10 14:02:00', '44': '2018-10-10 14:01:00', '45': '2018-10-10 14:00:00', '46': '2018-10-10 13:59:00', '47': '2018-10-10 13:58:00', '48': '2018-10-10 13:56:00', '49': '2018-10-10 13:55:00', '50': '2018-10-10 13:54:00', '51': '2018-10-10 13:52:00', '52': '2018-10-10 13:51:00', '53': '2018-10-10 13:50:00', '54': '2018-10-10 13:49:00', '55': '2018-10-10 13:48:00', '56': '2018-10-10 13:47:00', '57': '2018-10-10 13:46:00', '58': '2018-10-10 13:45:00', '59': '2018-10-10 13:43:00', '60': '2018-10-10 13:42:00', '61': '2018-10-10 13:41:00', '62': '2018-10-10 13:40:00', '63': '2018-10-10 13:39:00', '64': '2018-10-10 13:38:00', '65': '2018-10-10 13:36:00', '66': '2018-10-10 13:35:00', '67': '2018-10-10 13:34:00', '68': '2018-10-10 13:33:00', '69': '2018-10-10 13:32:00', '70': '2018-10-10 13:31:00', '71': '2018-10-10 13:30:00', '72': '2018-10-10 13:29:00', '73': '2018-10-10 13:28:00', '74': '2018-10-10 13:27:00', '75': '2018-10-10 13:26:00', '76': '2018-10-10 13:25:00', '77': '2018-10-10 13:24:00', '78': '2018-10-10 13:23:00', '79': '2018-10-10 13:22:00', '80': '2018-10-10 13:21:00', '81': '2018-10-10 13:20:00', '82': '2018-10-10 13:18:00', '83': '2018-10-10 13:17:00', '84': '2018-10-10 13:15:00', '85': '2018-10-10 13:14:00', '86': '2018-10-10 13:13:00', '87': '2018-10-10 13:12:00', '88': '2018-10-10 13:11:00', '89': '2018-10-10 13:10:00', '90': '2018-10-10 13:09:00', '91': '2018-10-10 13:08:00', '92': '2018-10-10 13:07:00', '93': '2018-10-10 13:06:00', '94': '2018-10-10 13:04:00', '95': '2018-10-10 13:03:00', '96': '2018-10-10 13:02:00', '97': '2018-10-10 13:01:00', '98': '2018-10-10 11:30:00', '99': '2018-10-10 11:29:00', '100': '2018-10-10 11:28:00', '101': '2018-10-10 11:27:00', '102': '2018-10-10 11:26:00', '103': '2018-10-10 11:25:00', '104': '2018-10-10 11:24:00', '105': '2018-10-10 11:23:00', '106': '2018-10-10 11:20:00', '107': '2018-10-10 11:17:00', '108': '2018-10-10 11:16:00', '109': '2018-10-10 11:15:00', '110': '2018-10-10 11:14:00', '111': '2018-10-10 11:13:00', '112': '2018-10-10 11:12:00', '113': '2018-10-10 11:11:00', '114': '2018-10-10 11:08:00', '115': '2018-10-10 11:06:00', '116': '2018-10-10 11:05:00', '117': '2018-10-10 11:04:00', '118': '2018-10-10 11:03:00', '119': '2018-10-10 11:02:00', '120': '2018-10-10 11:01:00', '121': '2018-10-10 11:00:00', '122': '2018-10-10 10:59:00', '123': '2018-10-10 10:57:00', '124': '2018-10-10 10:56:00', '125': '2018-10-10 10:55:00', '126': '2018-10-10 10:54:00', '127': '2018-10-10 10:53:00', '128': '2018-10-10 10:52:00', '129': '2018-10-10 10:51:00', '130': '2018-10-10 10:50:00', '131': '2018-10-10 10:49:00', '132': '2018-10-10 10:48:00', '133': '2018-10-10 10:47:00', '134': '2018-10-10 10:46:00', '135': '2018-10-10 10:44:00', '136': '2018-10-10 10:42:00', '137': '2018-10-10 10:41:00', '138': '2018-10-10 10:40:00', '139': '2018-10-10 10:39:00', '140': '2018-10-10 10:38:00', '141': '2018-10-10 10:37:00', '142': '2018-10-10 10:36:00', '143': '2018-10-10 10:35:00', '144': '2018-10-10 10:34:00', '145': '2018-10-10 10:33:00', '146': '2018-10-10 10:32:00', '147': '2018-10-10 10:31:00', '148': '2018-10-10 10:30:00', '149': '2018-10-10 10:29:00', '150': '2018-10-10 10:28:00', '151': '2018-10-10 10:27:00', '152': '2018-10-10 10:26:00', '153': '2018-10-10 10:24:00', '154': '2018-10-10 10:23:00', '155': '2018-10-10 10:20:00', '156': '2018-10-10 10:19:00', '157': '2018-10-10 10:18:00', '158': '2018-10-10 10:17:00', '159': '2018-10-10 10:16:00', '160': '2018-10-10 10:13:00', '161': '2018-10-10 10:12:00', '162': '2018-10-10 10:11:00', '163': '2018-10-10 10:10:00', '164': '2018-10-10 10:09:00', '165': '2018-10-10 10:08:00', '166': '2018-10-10 10:07:00', '167': '2018-10-10 10:06:00', '168': '2018-10-10 10:05:00', '169': '2018-10-10 10:04:00', '170': '2018-10-10 10:03:00', '171': '2018-10-10 10:02:00', '172': '2018-10-10 10:01:00', '173': '2018-10-10 10:00:00', '174': '2018-10-10 09:59:00', '175': '2018-10-10 09:58:00', '176': '2018-10-10 09:55:00', '177': '2018-10-10 09:54:00', '178': '2018-10-10 09:53:00', '179': '2018-10-10 09:52:00', '180': '2018-10-10 09:50:00', '181': '2018-10-10 09:49:00', '182': '2018-10-10 09:48:00', '183': '2018-10-10 09:47:00', '184': '2018-10-10 09:46:00', '185': '2018-10-10 09:45:00', '186': '2018-10-10 09:44:00', '187': '2018-10-10 09:43:00', '188': '2018-10-10 09:42:00', '189': '2018-10-10 09:41:00', '190': '2018-10-10 09:40:00', '191': '2018-10-10 09:39:00', '192': '2018-10-10 09:38:00', '193': '2018-10-10 09:36:00', '194': '2018-10-10 09:35:00', '195': '2018-10-10 09:34:00', '196': '2018-10-10 09:33:00', '197': '2018-10-10 09:32:00', '198': '2018-10-10 09:31:00', '199': '2018-10-10 09:30:00', '200': '2018-10-09 15:00:00', '201': '2018-10-09 14:59:00', '202': '2018-10-09 14:58:00', '203': '2018-10-09 14:57:00', '204': '2018-10-09 14:56:00', '205': '2018-10-09 14:54:00', '206': '2018-10-09 14:53:00', '207': '2018-10-09 14:52:00', '208': '2018-10-09 14:51:00', '209': '2018-10-09 14:49:00', '210': '2018-10-09 14:47:00', '211': '2018-10-09 14:46:00', '212': '2018-10-09 14:45:00', '213': '2018-10-09 14:44:00', '214': '2018-10-09 14:41:00', '215': '2018-10-09 14:40:00', '216': '2018-10-09 14:38:00', '217': '2018-10-09 14:37:00', '218': '2018-10-09 14:36:00', '219': '2018-10-09 14:35:00', '220': '2018-10-09 14:33:00', '221': '2018-10-09 14:32:00', '222': '2018-10-09 14:31:00', '223': '2018-10-09 14:30:00', '224': '2018-10-09 14:29:00', '225': '2018-10-09 14:28:00', '226': '2018-10-09 14:27:00', '227': '2018-10-09 14:26:00', '228': '2018-10-09 14:25:00', '229': '2018-10-09 14:24:00', '230': '2018-10-09 14:23:00', '231': '2018-10-09 14:22:00', '232': '2018-10-09 14:21:00', '233': '2018-10-09 14:20:00', '234': '2018-10-09 14:19:00', '235': '2018-10-09 14:18:00', '236': '2018-10-09 14:17:00', '237': '2018-10-09 14:16:00', '238': '2018-10-09 14:15:00', '239': '2018-10-09 14:14:00', '240': '2018-10-09 14:13:00', '241': '2018-10-09 14:12:00', '242': '2018-10-09 14:11:00', '243': '2018-10-09 14:10:00', '244': '2018-10-09 14:09:00', '245': '2018-10-09 14:08:00', '246': '2018-10-09 14:07:00', '247': '2018-10-09 14:06:00', '248': '2018-10-09 14:05:00', '249': '2018-10-09 14:04:00', '250': '2018-10-09 14:03:00', '251': '2018-10-09 14:02:00', '252': '2018-10-09 14:00:00', '253': '2018-10-09 13:59:00', '254': '2018-10-09 13:58:00', '255': '2018-10-09 13:57:00', '256': '2018-10-09 13:56:00', '257': '2018-10-09 13:55:00', '258': '2018-10-09 13:54:00', '259': '2018-10-09 13:53:00', '260': '2018-10-09 13:51:00', '261': '2018-10-09 13:50:00', '262': '2018-10-09 13:49:00', '263': '2018-10-09 13:48:00', '264': '2018-10-09 13:47:00', '265': '2018-10-09 13:46:00', '266': '2018-10-09 13:45:00', '267': '2018-10-09 13:43:00', '268': '2018-10-09 13:42:00', '269': '2018-10-09 13:41:00', '270': '2018-10-09 13:40:00', '271': '2018-10-09 13:39:00', '272': '2018-10-09 13:38:00', '273': '2018-10-09 13:37:00', '274': '2018-10-09 13:36:00', '275': '2018-10-09 13:35:00', '276': '2018-10-09 13:34:00', '277': '2018-10-09 13:33:00', '278': '2018-10-09 13:32:00', '279': '2018-10-09 13:31:00', '280': '2018-10-09 13:30:00', '281': '2018-10-09 13:29:00', '282': '2018-10-09 13:28:00', '283': '2018-10-09 13:27:00', '284': '2018-10-09 13:26:00', '285': '2018-10-09 13:24:00', '286': '2018-10-09 13:23:00', '287': '2018-10-09 13:21:00', '288': '2018-10-09 13:20:00', '289': '2018-10-09 13:19:00', '290': '2018-10-09 13:18:00', '291': '2018-10-09 13:17:00', '292': '2018-10-09 13:16:00', '293': '2018-10-09 13:15:00', '294': '2018-10-09 13:13:00', '295': '2018-10-09 13:12:00', '296': '2018-10-09 13:10:00', '297': '2018-10-09 13:09:00', '298': '2018-10-09 13:08:00', '299': '2018-10-09 13:05:00', '300': '2018-10-09 13:04:00', '301': '2018-10-09 13:03:00', '302': '2018-10-09 13:01:00', '303': '2018-10-09 11:30:00', '304': '2018-10-09 11:28:00', '305': '2018-10-09 11:27:00', '306': '2018-10-09 11:25:00', '307': '2018-10-09 11:24:00', '308': '2018-10-09 11:22:00', '309': '2018-10-09 11:21:00', '310': '2018-10-09 11:19:00', '311': '2018-10-09 11:17:00', '312': '2018-10-09 11:16:00', '313': '2018-10-09 11:15:00', '314': '2018-10-09 11:14:00', '315': '2018-10-09 11:13:00', '316': '2018-10-09 11:11:00', '317': '2018-10-09 11:10:00', '318': '2018-10-09 11:09:00', '319': '2018-10-09 11:08:00', '320': '2018-10-09 11:06:00', '321': '2018-10-09 11:05:00', '322': '2018-10-09 11:03:00', '323': '2018-10-09 11:02:00', '324': '2018-10-09 11:01:00', '325': '2018-10-09 10:59:00', '326': '2018-10-09 10:58:00', '327': '2018-10-09 10:57:00', '328': '2018-10-09 10:56:00', '329': '2018-10-09 10:55:00', '330': '2018-10-09 10:53:00', '331': '2018-10-09 10:51:00', '332': '2018-10-09 10:50:00', '333': '2018-10-09 10:49:00', '334': '2018-10-09 10:48:00', '335': '2018-10-09 10:47:00', '336': '2018-10-09 10:46:00', '337': '2018-10-09 10:45:00', '338': '2018-10-09 10:43:00', '339': '2018-10-09 10:41:00', '340': '2018-10-09 10:40:00', '341': '2018-10-09 10:39:00', '342': '2018-10-09 10:38:00', '343': '2018-10-09 10:37:00', '344': '2018-10-09 10:36:00', '345': '2018-10-09 10:35:00', '346': '2018-10-09 10:34:00', '347': '2018-10-09 10:33:00', '348': '2018-10-09 10:32:00', '349': '2018-10-09 10:31:00', '350': '2018-10-09 10:30:00', '351': '2018-10-09 10:29:00', '352': '2018-10-09 10:28:00', '353': '2018-10-09 10:27:00', '354': '2018-10-09 10:26:00', '355': '2018-10-09 10:25:00', '356': '2018-10-09 10:24:00', '357': '2018-10-09 10:23:00', '358': '2018-10-09 10:21:00', '359': '2018-10-09 10:20:00', '360': '2018-10-09 10:19:00', '361': '2018-10-09 10:18:00', '362': '2018-10-09 10:17:00', '363': '2018-10-09 10:16:00', '364': '2018-10-09 10:15:00', '365': '2018-10-09 10:14:00', '366': '2018-10-09 10:13:00', '367': '2018-10-09 10:12:00', '368': '2018-10-09 10:11:00', '369': '2018-10-09 10:09:00', '370': '2018-10-09 10:08:00', '371': '2018-10-09 10:07:00', '372': '2018-10-09 10:06:00', '373': '2018-10-09 10:05:00', '374': '2018-10-09 10:04:00', '375': '2018-10-09 10:03:00', '376': '2018-10-09 10:02:00', '377': '2018-10-09 10:01:00', '378': '2018-10-09 10:00:00', '379': '2018-10-09 09:59:00', '380': '2018-10-09 09:57:00', '381': '2018-10-09 09:56:00', '382': '2018-10-09 09:55:00', '383': '2018-10-09 09:54:00', '384': '2018-10-09 09:51:00', '385': '2018-10-09 09:50:00', '386': '2018-10-09 09:49:00', '387': '2018-10-09 09:48:00', '388': '2018-10-09 09:47:00', '389': '2018-10-09 09:46:00', '390': '2018-10-09 09:45:00', '391': '2018-10-09 09:44:00', '392': '2018-10-09 09:43:00', '393': '2018-10-09 09:42:00', '394': '2018-10-09 09:41:00', '395': '2018-10-09 09:40:00', '396': '2018-10-09 09:39:00', '397': '2018-10-09 09:37:00', '398': '2018-10-09 09:36:00', '399': '2018-10-09 09:35:00', '400': '2018-10-09 09:33:00', '401': '2018-10-09 09:30:00', '402': '2018-10-08 15:00:00', '403': '2018-10-08 14:59:00', '404': '2018-10-08 14:58:00', '405': '2018-10-08 14:57:00', '406': '2018-10-08 14:56:00', '407': '2018-10-08 14:55:00', '408': '2018-10-08 14:54:00', '409': '2018-10-08 14:53:00', '410': '2018-10-08 14:52:00', '411': '2018-10-08 14:51:00', '412': '2018-10-08 14:50:00', '413': '2018-10-08 14:49:00', '414': '2018-10-08 14:46:00', '415': '2018-10-08 14:45:00', '416': '2018-10-08 14:44:00', '417': '2018-10-08 14:43:00', '418': '2018-10-08 14:42:00', '419': '2018-10-08 14:40:00', '420': '2018-10-08 14:39:00', '421': '2018-10-08 14:38:00', '422': '2018-10-08 14:37:00', '423': '2018-10-08 14:36:00', '424': '2018-10-08 14:35:00', '425': '2018-10-08 14:34:00', '426': '2018-10-08 14:33:00', '427': '2018-10-08 14:32:00', '428': '2018-10-08 14:31:00', '429': '2018-10-08 14:30:00', '430': '2018-10-08 14:29:00', '431': '2018-10-08 14:28:00', '432': '2018-10-08 14:27:00', '433': '2018-10-08 14:26:00', '434': '2018-10-08 14:25:00', '435': '2018-10-08 14:23:00', '436': '2018-10-08 14:20:00', '437': '2018-10-08 14:19:00', '438': '2018-10-08 14:17:00', '439': '2018-10-08 14:16:00', '440': '2018-10-08 14:15:00', '441': '2018-10-08 14:14:00', '442': '2018-10-08 14:13:00', '443': '2018-10-08 14:12:00', '444': '2018-10-08 14:11:00', '445': '2018-10-08 14:10:00', '446': '2018-10-08 14:09:00', '447': '2018-10-08 14:08:00', '448': '2018-10-08 14:07:00', '449': '2018-10-08 14:06:00', '450': '2018-10-08 14:04:00', '451': '2018-10-08 14:03:00', '452': '2018-10-08 14:01:00', '453': '2018-10-08 14:00:00', '454': '2018-10-08 13:59:00', '455': '2018-10-08 13:58:00', '456': '2018-10-08 13:57:00', '457': '2018-10-08 13:56:00', '458': '2018-10-08 13:55:00', '459': '2018-10-08 13:54:00', '460': '2018-10-08 13:53:00', '461': '2018-10-08 13:52:00', '462': '2018-10-08 13:51:00', '463': '2018-10-08 13:50:00', '464': '2018-10-08 13:49:00', '465': '2018-10-08 13:48:00', '466': '2018-10-08 13:46:00', '467': '2018-10-08 13:45:00', '468': '2018-10-08 13:43:00', '469': '2018-10-08 13:42:00', '470': '2018-10-08 13:41:00', '471': '2018-10-08 13:39:00', '472': '2018-10-08 13:38:00', '473': '2018-10-08 13:37:00', '474': '2018-10-08 13:36:00', '475': '2018-10-08 13:35:00', '476': '2018-10-08 13:34:00', '477': '2018-10-08 13:32:00', '478': '2018-10-08 13:31:00', '479': '2018-10-08 13:30:00', '480': '2018-10-08 13:29:00', '481': '2018-10-08 13:28:00', '482': '2018-10-08 13:27:00', '483': '2018-10-08 13:26:00', '484': '2018-10-08 13:25:00', '485': '2018-10-08 13:23:00', '486': '2018-10-08 13:22:00', '487': '2018-10-08 13:20:00', '488': '2018-10-08 13:18:00', '489': '2018-10-08 13:17:00', '490': '2018-10-08 13:16:00', '491': '2018-10-08 13:15:00', '492': '2018-10-08 13:14:00', '493': '2018-10-08 13:13:00', '494': '2018-10-08 13:11:00', '495': '2018-10-08 13:10:00', '496': '2018-10-08 13:09:00', '497': '2018-10-08 13:08:00', '498': '2018-10-08 13:07:00', '499': '2018-10-08 13:06:00', '500': '2018-10-08 13:05:00', '501': '2018-10-08 13:04:00', '502': '2018-10-08 13:03:00', '503': '2018-10-08 13:01:00', '504': '2018-10-08 11:30:00', '505': '2018-10-08 11:29:00', '506': '2018-10-08 11:28:00', '507': '2018-10-08 11:26:00', '508': '2018-10-08 11:25:00', '509': '2018-10-08 11:24:00', '510': '2018-10-08 11:23:00', '511': '2018-10-08 11:21:00', '512': '2018-10-08 11:20:00', '513': '2018-10-08 11:19:00', '514': '2018-10-08 11:18:00', '515': '2018-10-08 11:17:00', '516': '2018-10-08 11:15:00', '517': '2018-10-08 11:13:00', '518': '2018-10-08 11:12:00', '519': '2018-10-08 11:11:00', '520': '2018-10-08 11:10:00', '521': '2018-10-08 11:09:00', '522': '2018-10-08 11:07:00', '523': '2018-10-08 11:06:00', '524': '2018-10-08 11:05:00', '525': '2018-10-08 11:04:00', '526': '2018-10-08 11:03:00', '527': '2018-10-08 11:01:00', '528': '2018-10-08 11:00:00', '529': '2018-10-08 10:59:00', '530': '2018-10-08 10:58:00', '531': '2018-10-08 10:57:00', '532': '2018-10-08 10:53:00', '533': '2018-10-08 10:52:00', '534': '2018-10-08 10:51:00', '535': '2018-10-08 10:50:00', '536': '2018-10-08 10:49:00', '537': '2018-10-08 10:48:00', '538': '2018-10-08 10:46:00', '539': '2018-10-08 10:44:00', '540': '2018-10-08 10:42:00', '541': '2018-10-08 10:41:00', '542': '2018-10-08 10:40:00', '543': '2018-10-08 10:37:00', '544': '2018-10-08 10:36:00', '545': '2018-10-08 10:35:00', '546': '2018-10-08 10:34:00', '547': '2018-10-08 10:33:00', '548': '2018-10-08 10:32:00', '549': '2018-10-08 10:30:00', '550': '2018-10-08 10:29:00', '551': '2018-10-08 10:28:00', '552': '2018-10-08 10:27:00', '553': '2018-10-08 10:26:00', '554': '2018-10-08 10:25:00', '555': '2018-10-08 10:23:00', '556': '2018-10-08 10:21:00', '557': '2018-10-08 10:20:00', '558': '2018-10-08 10:17:00', '559': '2018-10-08 10:16:00', '560': '2018-10-08 10:14:00', '561': '2018-10-08 10:13:00', '562': '2018-10-08 10:10:00', '563': '2018-10-08 10:09:00', '564': '2018-10-08 10:07:00', '565': '2018-10-08 10:06:00', '566': '2018-10-08 10:05:00', '567': '2018-10-08 10:03:00', '568': '2018-10-08 10:01:00', '569': '2018-10-08 10:00:00', '570': '2018-10-08 09:58:00', '571': '2018-10-08 09:57:00', '572': '2018-10-08 09:55:00', '573': '2018-10-08 09:54:00', '574': '2018-10-08 09:53:00', '575': '2018-10-08 09:50:00', '576': '2018-10-08 09:48:00', '577': '2018-10-08 09:47:00', '578': '2018-10-08 09:46:00', '579': '2018-10-08 09:45:00', '580': '2018-10-08 09:44:00', '581': '2018-10-08 09:43:00', '582': '2018-10-08 09:41:00', '583': '2018-10-08 09:40:00', '584': '2018-10-08 09:38:00', '585': '2018-10-08 09:37:00', '586': '2018-10-08 09:35:00', '587': '2018-10-08 09:33:00', '588': '2018-10-08 09:31:00', '589': '2018-10-08 09:30:00'}, 'close': {'0': 10.45, '1': 10.43, '2': 10.43, '3': 10.43, '4': 10.44, '5': 10.42, '6': 10.39, '7': 10.4, '8': 10.4, '9': 10.4, '10': 10.4, '11': 10.41, '12': 10.41, '13': 10.4, '14': 10.4, '15': 10.42, '16': 10.41, '17': 10.42, '18': 10.41, '19': 10.42, '20': 10.45, '21': 10.45, '22': 10.43, '23': 10.45, '24': 10.44, '25': 10.43, '26': 10.42, '27': 10.4, '28': 10.41, '29': 10.43, '30': 10.45, '31': 10.45, '32': 10.45, '33': 10.43, '34': 10.47, '35': 10.48, '36': 10.49, '37': 10.49, '38': 10.5, '39': 10.51, '40': 10.51, '41': 10.5, '42': 10.48, '43': 10.48, '44': 10.48, '45': 10.47, '46': 10.47, '47': 10.49, '48': 10.46, '49': 10.47, '50': 10.48, '51': 10.47, '52': 10.48, '53': 10.47, '54': 10.48, '55': 10.49, '56': 10.49, '57': 10.5, '58': 10.49, '59': 10.48, '60': 10.48, '61': 10.48, '62': 10.5, '63': 10.5, '64': 10.5, '65': 10.5, '66': 10.49, '67': 10.53, '68': 10.51, '69': 10.52, '70': 10.51, '71': 10.51, '72': 10.52, '73': 10.51, '74': 10.51, '75': 10.5, '76': 10.5, '77': 10.51, '78': 10.51, '79': 10.51, '80': 10.5, '81': 10.49, '82': 10.47, '83': 10.46, '84': 10.45, '85': 10.46, '86': 10.45, '87': 10.43, '88': 10.44, '89': 10.44, '90': 10.43, '91': 10.44, '92': 10.44, '93': 10.43, '94': 10.44, '95': 10.44, '96': 10.44, '97': 10.44, '98': 10.45, '99': 10.46, '100': 10.46, '101': 10.48, '102': 10.48, '103': 10.49, '104': 10.49, '105': 10.48, '106': 10.48, '107': 10.46, '108': 10.46, '109': 10.47, '110': 10.47, '111': 10.48, '112': 10.48, '113': 10.48, '114': 10.5, '115': 10.49, '116': 10.48, '117': 10.47, '118': 10.49, '119': 10.49, '120': 10.49, '121': 10.49, '122': 10.52, '123': 10.51, '124': 10.53, '125': 10.55, '126': 10.54, '127': 10.54, '128': 10.54, '129': 10.53, '130': 10.54, '131': 10.56, '132': 10.54, '133': 10.54, '134': 10.55, '135': 10.59, '136': 10.59, '137': 10.58, '138': 10.58, '139': 10.59, '140': 10.58, '141': 10.59, '142': 10.6, '143': 10.6, '144': 10.6, '145': 10.6, '146': 10.59, '147': 10.6, '148': 10.6, '149': 10.59, '150': 10.59, '151': 10.57, '152': 10.58, '153': 10.6, '154': 10.6, '155': 10.62, '156': 10.62, '157': 10.62, '158': 10.62, '159': 10.62, '160': 10.6, '161': 10.62, '162': 10.65, '163': 10.63, '164': 10.63, '165': 10.62, '166': 10.64, '167': 10.64, '168': 10.65, '169': 10.65, '170': 10.65, '171': 10.64, '172': 10.63, '173': 10.61, '174': 10.6, '175': 10.6, '176': 10.6, '177': 10.58, '178': 10.59, '179': 10.62, '180': 10.65, '181': 10.59, '182': 10.61, '183': 10.58, '184': 10.6, '185': 10.6, '186': 10.57, '187': 10.55, '188': 10.52, '189': 10.48, '190': 10.48, '191': 10.5, '192': 10.49, '193': 10.5, '194': 10.53, '195': 10.54, '196': 10.54, '197': 10.5, '198': 10.51, '199': 10.54, '200': 10.56, '201': 10.54, '202': 10.54, '203': 10.54, '204': 10.54, '205': 10.52, '206': 10.5, '207': 10.5, '208': 10.51, '209': 10.52, '210': 10.5, '211': 10.5, '212': 10.5, '213': 10.5, '214': 10.49, '215': 10.5, '216': 10.5, '217': 10.49, '218': 10.49, '219': 10.52, '220': 10.54, '221': 10.52, '222': 10.55, '223': 10.56, '224': 10.55, '225': 10.55, '226': 10.52, '227': 10.5, '228': 10.5, '229': 10.5, '230': 10.51, '231': 10.5, '232': 10.49, '233': 10.48, '234': 10.49, '235': 10.47, '236': 10.5, '237': 10.49, '238': 10.48, '239': 10.49, '240': 10.5, '241': 10.5, '242': 10.49, '243': 10.5, '244': 10.5, '245': 10.51, '246': 10.49, '247': 10.48, '248': 10.48, '249': 10.49, '250': 10.49, '251': 10.49, '252': 10.49, '253': 10.5, '254': 10.5, '255': 10.51, '256': 10.5, '257': 10.47, '258': 10.47, '259': 10.48, '260': 10.52, '261': 10.5, '262': 10.53, '263': 10.55, '264': 10.55, '265': 10.55, '266': 10.56, '267': 10.54, '268': 10.55, '269': 10.54, '270': 10.52, '271': 10.54, '272': 10.55, '273': 10.55, '274': 10.55, '275': 10.55, '276': 10.55, '277': 10.55, '278': 10.54, '279': 10.55, '280': 10.55, '281': 10.56, '282': 10.55, '283': 10.55, '284': 10.56, '285': 10.54, '286': 10.55, '287': 10.59, '288': 10.58, '289': 10.59, '290': 10.58, '291': 10.6, '292': 10.61, '293': 10.63, '294': 10.63, '295': 10.67, '296': 10.62, '297': 10.61, '298': 10.61, '299': 10.62, '300': 10.62, '301': 10.61, '302': 10.59, '303': 10.64, '304': 10.65, '305': 10.65, '306': 10.62, '307': 10.59, '308': 10.55, '309': 10.54, '310': 10.47, '311': 10.47, '312': 10.47, '313': 10.45, '314': 10.47, '315': 10.45, '316': 10.43, '317': 10.43, '318': 10.42, '319': 10.42, '320': 10.44, '321': 10.45, '322': 10.47, '323': 10.47, '324': 10.47, '325': 10.46, '326': 10.48, '327': 10.45, '328': 10.45, '329': 10.44, '330': 10.44, '331': 10.42, '332': 10.43, '333': 10.41, '334': 10.41, '335': 10.41, '336': 10.42, '337': 10.41, '338': 10.41, '339': 10.43, '340': 10.44, '341': 10.44, '342': 10.45, '343': 10.47, '344': 10.49, '345': 10.49, '346': 10.5, '347': 10.47, '348': 10.46, '349': 10.45, '350': 10.44, '351': 10.43, '352': 10.43, '353': 10.43, '354': 10.44, '355': 10.45, '356': 10.45, '357': 10.44, '358': 10.47, '359': 10.45, '360': 10.46, '361': 10.47, '362': 10.48, '363': 10.48, '364': 10.49, '365': 10.5, '366': 10.52, '367': 10.51, '368': 10.49, '369': 10.47, '370': 10.46, '371': 10.48, '372': 10.47, '373': 10.42, '374': 10.45, '375': 10.46, '376': 10.45, '377': 10.45, '378': 10.46, '379': 10.47, '380': 10.46, '381': 10.46, '382': 10.47, '383': 10.47, '384': 10.45, '385': 10.44, '386': 10.39, '387': 10.42, '388': 10.43, '389': 10.43, '390': 10.47, '391': 10.47, '392': 10.47, '393': 10.48, '394': 10.48, '395': 10.49, '396': 10.5, '397': 10.47, '398': 10.49, '399': 10.51, '400': 10.53, '401': 10.46, '402': 10.45, '403': 10.48, '404': 10.48, '405': 10.48, '406': 10.49, '407': 10.5, '408': 10.5, '409': 10.5, '410': 10.48, '411': 10.5, '412': 10.54, '413': 10.54, '414': 10.54, '415': 10.53, '416': 10.54, '417': 10.55, '418': 10.57, '419': 10.56, '420': 10.56, '421': 10.56, '422': 10.55, '423': 10.55, '424': 10.56, '425': 10.56, '426': 10.57, '427': 10.57, '428': 10.57, '429': 10.57, '430': 10.57, '431': 10.56, '432': 10.57, '433': 10.55, '434': 10.55, '435': 10.57, '436': 10.6, '437': 10.59, '438': 10.6, '439': 10.6, '440': 10.59, '441': 10.59, '442': 10.58, '443': 10.57, '444': 10.57, '445': 10.59, '446': 10.6, '447': 10.62, '448': 10.61, '449': 10.64, '450': 10.64, '451': 10.63, '452': 10.63, '453': 10.63, '454': 10.65, '455': 10.65, '456': 10.65, '457': 10.65, '458': 10.66, '459': 10.66, '460': 10.65, '461': 10.65, '462': 10.66, '463': 10.68, '464': 10.67, '465': 10.64, '466': 10.65, '467': 10.64, '468': 10.65, '469': 10.66, '470': 10.65, '471': 10.64, '472': 10.65, '473': 10.64, '474': 10.63, '475': 10.63, '476': 10.64, '477': 10.66, '478': 10.65, '479': 10.64, '480': 10.63, '481': 10.64, '482': 10.62, '483': 10.63, '484': 10.64, '485': 10.64, '486': 10.64, '487': 10.63, '488': 10.62, '489': 10.62, '490': 10.64, '491': 10.63, '492': 10.64, '493': 10.64, '494': 10.63, '495': 10.63, '496': 10.63, '497': 10.63, '498': 10.61, '499': 10.6, '500': 10.59, '501': 10.6, '502': 10.59, '503': 10.6, '504': 10.6, '505': 10.62, '506': 10.62, '507': 10.63, '508': 10.62, '509': 10.64, '510': 10.66, '511': 10.65, '512': 10.67, '513': 10.64, '514': 10.63, '515': 10.63, '516': 10.64, '517': 10.62, '518': 10.62, '519': 10.63, '520': 10.61, '521': 10.58, '522': 10.58, '523': 10.57, '524': 10.58, '525': 10.57, '526': 10.57, '527': 10.57, '528': 10.58, '529': 10.6, '530': 10.6, '531': 10.61, '532': 10.61, '533': 10.62, '534': 10.63, '535': 10.62, '536': 10.63, '537': 10.62, '538': 10.57, '539': 10.54, '540': 10.57, '541': 10.56, '542': 10.58, '543': 10.57, '544': 10.57, '545': 10.57, '546': 10.57, '547': 10.56, '548': 10.58, '549': 10.6, '550': 10.59, '551': 10.61, '552': 10.63, '553': 10.62, '554': 10.62, '555': 10.63, '556': 10.61, '557': 10.59, '558': 10.61, '559': 10.63, '560': 10.63, '561': 10.63, '562': 10.63, '563': 10.64, '564': 10.66, '565': 10.65, '566': 10.63, '567': 10.61, '568': 10.59, '569': 10.63, '570': 10.69, '571': 10.7, '572': 10.69, '573': 10.7, '574': 10.72, '575': 10.77, '576': 10.75, '577': 10.74, '578': 10.76, '579': 10.75, '580': 10.73, '581': 10.73, '582': 10.78, '583': 10.78, '584': 10.76, '585': 10.73, '586': 10.72, '587': 10.68, '588': 10.66, '589': 10.7}}"
        mongodb_client.upsert_stock_price(stock, StockDataType.Daily, df, start_date)
        print("success to insert stock %s . with df: %s" % (stock, df.to_json()))

        get_rec = mongodb_client.get_record(StockDataType.Daily, stock, start_date)
        print(get_rec)


test()